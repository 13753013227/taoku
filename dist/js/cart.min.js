"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}var Cart=function(){function t(){_classCallCheck(this,t),this.initCart(),this.addEvent(),this.initPrice()}return _createClass(t,[{key:"initCart",value:function(){var t,e=$(".buy-goods"),a=strToObj(window.localStorage.getItem("box"));for(t in a){var n=a[t];e[0].innerHTML+='<tbody data-goods-id="'.concat(t,'">\n      <tr>\n        <td class="good-pic">\n          <a href="javascript:;">\n            <img src="').concat(n.src,'" alt="">\n          </a>\n        </td>\n        <td class="good-txt">\n          <a href="javascript:;">').concat(n.name,"</a>\n        </td>\n        <td>").concat(n.price,'</td>\n        <td>\n          <div class="good-num">\n            <a href="javaScript:;" class="red">-</a>\n            <input type="text" value="').concat(n.num,'" class="inp">\n            <a href="javaScript:;" class="plus">+</a>\n          </div>\n        </td>\n        <td>￥0.00</td>\n        <td>999</td>\n        <td class="good-total-price">').concat(n.price,'</td>\n        <td class="operate">\n          <a href="javascript:;">删除</a>\n        </td>\n      </tr>\n    </tbody>')}}},{key:"addEvent",value:function(){var i=this,t=$(".plus"),e=$(".red"),r=$(".inp");t.each(function(o,t){$(t).click(function(){var t=$(this).parents("tbody").attr("data-goods-id"),e=window.localStorage,a=strToObj(e.getItem("box")),n=$(r[o]).attr("value");n++,a[t].num=n,$(r[o]).attr("value",n);n=$(this).parents("tbody").find(".good-total-price"),t=a[t].num*a[t].price.slice(1);n.text(t.toFixed(2)),e.setItem("box",JSON.stringify(a)),i.initPrice()})}),e.each(function(o,t){$(t).click(function(){var t=$(this).parents("tbody").attr("data-goods-id"),e=window.localStorage,a=strToObj(e.getItem("box")),n=$(r[o]).attr("value");1<n?(n--,$(r[o]).attr("value",n)):$(r[o]).attr("value",1),a[t].num=n,$(r[o]).attr("value",n);n=$(this).parents("tbody").find(".good-total-price"),t=a[t].num*a[t].price.slice(1);n.text("￥"+t.toFixed(2)),e.setItem("box",JSON.stringify(a)),i.initPrice()})}),$(".operate a").each(function(t,e){$(e).click(function(){var t=$(this).parents("tbody").attr("data-goods-id");console.log(t);var e=window.localStorage,a=strToObj(e.getItem("box"));delete a[t],e.setItem("box",JSON.stringify(a)),$(this).parents("tbody").remove()})})}},{key:"initPrice",value:function(){var t,e=$(".sum_money"),a=$(".count em"),n=strToObj(window.localStorage.getItem("box")),o=0;for(t in n)o+=n[t].num*n[t].price.slice(1);e.text("￥".concat(o.toFixed(2))),a.text("￥".concat(o.toFixed(2)))}}]),t}();function strToObj(t){return t?JSON.parse(t):{}}new Cart;